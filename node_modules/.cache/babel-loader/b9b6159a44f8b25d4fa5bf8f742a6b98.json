{"ast":null,"code":"import _slicedToArray from\"/Users/nancy/project/react-success/react-hook/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import{Layout}from'antd';import menuConfig from'../menuConfig';import HeadMenu from'../component/HeadMenu';import SideMenu from'../component/SideMenu';var Header=Layout.Header,Content=Layout.Content,Sider=Layout.Sider;export var BaseLayout=function BaseLayout(_ref){var location=_ref.location,children=_ref.children,loginStatus=_ref.loginStatus;var pathname=location.pathname;var _useState=useState({}),_useState2=_slicedToArray(_useState,2),menuInfo=_useState2[0],setMenuInfo=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),subMenu=_useState4[0],setSubMenu=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),selectPath=_useState6[0],setSelectPath=_useState6[1];var _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),currentPath=_useState8[0],setCurrentPath=_useState8[1];var pathChange=function pathChange(pathname,data,type){var dataMenu=data;if(type==='main'){dataMenu.mainMenu.forEach(function(item){if(pathname.indexOf(item.path)>-1){setSubMenu(item.children);dataMenu.selectMainMenu=item;dataMenu.paths=item;dataMenu.prePath='/'+item.path;dataMenu.subMenu=item.children;}});}if(type==='sub'){dataMenu.subMenu.forEach(function(item){if(pathname.indexOf(item.path)>-1){dataMenu.selectSubMenu=item;}});}if(type==='tab'){dataMenu.mainMenu.forEach(function(item){if(pathname.indexOf(item.path)>-1){setSubMenu(item.children);dataMenu.selectMainMenu=item;dataMenu.paths=item;dataMenu.prePath='/'+item.path;dataMenu.subMenu=item.children;dataMenu.selectSubMenu=item.children[0];}});}return dataMenu;};// 菜单信息随着路径变化\nuseEffect(function(){pathChange(pathname,menuConfig,'main');var newInfo=pathChange(pathname,menuConfig,'sub');setMenuInfo(newInfo);setSelectPath(\"\".concat(newInfo.selectMainMenu.path));setCurrentPath(\"\".concat(newInfo.prePath,\"/\").concat(newInfo.selectSubMenu.path));},[pathname]);var loginPath='/login';var redirectUrl=pathname===loginPath?'/':pathname;useEffect(function(){// <!--校验是否登陆-->\nif(loginStatus){Router.push(redirectUrl);}else{history.push('/login',{redirectUrl:redirectUrl});}},[]);if(pathname==='/login'){return/*#__PURE__*/React.createElement(\"div\",null,children);}var handleClick=function handleClick(value){var key=value.key;var newInfo=pathChange(pathname,menuConfig,'tab');setMenuInfo(newInfo);setSelectPath(key);};var handleSiderClick=function handleSiderClick(value){var key=value.key;var newInfo=pathChange(pathname,menuConfig,'sub');setMenuInfo(newInfo);setCurrentPath(key);};return/*#__PURE__*/React.createElement(Layout,null,/*#__PURE__*/React.createElement(Header,{className:\"header\"},/*#__PURE__*/React.createElement(\"div\",{className:\"logo\"}),/*#__PURE__*/React.createElement(HeadMenu,{menuInfo:menuInfo,handleClick:handleClick,selectPath:selectPath})),/*#__PURE__*/React.createElement(Content,null,/*#__PURE__*/React.createElement(Layout,null,/*#__PURE__*/React.createElement(Sider,{width:200},/*#__PURE__*/React.createElement(SideMenu,{menuInfo:menuInfo,subMenu:subMenu,handleSiderClick:handleSiderClick,currentPath:currentPath})),/*#__PURE__*/React.createElement(Content,null,children))));};","map":{"version":3,"sources":["/Users/nancy/project/react-success/react-hook/src/layout/BaseLayout.js"],"names":["React","useState","useEffect","Layout","menuConfig","HeadMenu","SideMenu","Header","Content","Sider","BaseLayout","location","children","loginStatus","pathname","menuInfo","setMenuInfo","subMenu","setSubMenu","selectPath","setSelectPath","currentPath","setCurrentPath","pathChange","data","type","dataMenu","mainMenu","forEach","item","indexOf","path","selectMainMenu","paths","prePath","selectSubMenu","newInfo","loginPath","redirectUrl","Router","push","history","handleClick","value","key","handleSiderClick"],"mappings":"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","sourcesContent":["import PropTypes from 'prop-types'\nimport React, { useState, useEffect } from 'react';\nimport {Layout} from 'antd'\nimport menuConfig from '../menuConfig'\nimport HeadMenu from '../component/HeadMenu';\nimport SideMenu from '../component/SideMenu';\nconst { Header, Content, Sider } = Layout;\nexport const BaseLayout = ({ location, children, loginStatus}) => {\n    const {pathname } = location;\n\n    const [menuInfo, setMenuInfo] = useState({});\n    const [subMenu, setSubMenu] = useState([]);\n    const [selectPath, setSelectPath] = useState('');\n    const [currentPath, setCurrentPath] = useState('');\n\n    const pathChange = (pathname, data, type) => {\n        const dataMenu = data\n        if(type === 'main' ) {\n            dataMenu.mainMenu.forEach(item => {\n                if(pathname.indexOf(item.path) > -1) {\n                    setSubMenu(item.children)\n                    dataMenu.selectMainMenu = item\n                    dataMenu.paths = item\n                    dataMenu.prePath = '/' + item.path\n                    dataMenu.subMenu = item.children\n                }\n            })\n        }\n        if( type === 'sub') {\n            dataMenu.subMenu.forEach(item => {\n                if(pathname.indexOf(item.path) > -1) {\n                    dataMenu.selectSubMenu = item\n                }\n            })\n        }\n\n        if( type === 'tab') {\n            dataMenu.mainMenu.forEach(item => {\n                if(pathname.indexOf(item.path) > -1) {\n                    setSubMenu(item.children)\n                    dataMenu.selectMainMenu = item\n                    dataMenu.paths = item\n                    dataMenu.prePath = '/' + item.path\n                    dataMenu.subMenu = item.children\n                    dataMenu.selectSubMenu = item.children[0]\n                }\n            })\n        }\n\n        return dataMenu\n    }\n    // 菜单信息随着路径变化\n    useEffect(() => {\n        pathChange(pathname, menuConfig, 'main');\n        const newInfo = pathChange(pathname, menuConfig, 'sub');\n        setMenuInfo(newInfo);\n        setSelectPath(`${newInfo.selectMainMenu.path}`)\n        setCurrentPath(`${newInfo.prePath}/${newInfo.selectSubMenu.path}`)\n    }, [pathname]);\n\n    const loginPath = '/login';\n    const redirectUrl = pathname === loginPath ? '/' : pathname;\n\n    useEffect(() => {\n        // <!--校验是否登陆-->\n        if (loginStatus) {\n            Router.push(redirectUrl);\n        } else {\n            history.push('/login', {\n                redirectUrl\n            });\n        }\n    }, []);\n\n    if (pathname === '/login') {\n        return <div>{children}</div>;\n    }\n\n    const handleClick = (value) => {\n        const { key } = value\n        const newInfo = pathChange(pathname, menuConfig, 'tab');\n        setMenuInfo(newInfo);\n        setSelectPath(key)\n    }\n\n    const handleSiderClick = (value) => {\n        const { key } = value\n        const newInfo = pathChange(pathname, menuConfig, 'sub');\n        setMenuInfo(newInfo);\n        setCurrentPath(key)\n    }\n\n\n\n    return (\n        <Layout>\n            <Header className=\"header\" >\n                <div className=\"logo\" />\n                <HeadMenu menuInfo={menuInfo} handleClick={ handleClick } selectPath={selectPath}/>\n            </Header>\n            <Content>\n                <Layout>\n                    <Sider width={200}>\n                        <SideMenu menuInfo={menuInfo}\n                                  subMenu={subMenu}\n                                  handleSiderClick={handleSiderClick}\n                                  currentPath={currentPath}/>\n                    </Sider>\n                    <Content>{children}</Content>\n                </Layout>\n            </Content>\n        </Layout>\n    )\n}\nBaseLayout.propTypes={\n    location: PropTypes.object\n}\n"]},"metadata":{},"sourceType":"module"}